<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>SB Admin 2 - Register</title>

    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css">
    <!-- css bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <!-- css fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
      integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
      crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- jquery cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- dataTables cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
      integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- jquery validate -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"
      integrity="sha512-rstIgDs0xPgmG6RX1Aba4KV5cWJbAMcvRCVmglpam9SoHZiUCyQVDdH2LPlxoHtrv17XWblE/V/PP+Tr04hbtA=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/4.0.0/jquery.validate.unobtrusive.min.js"
      integrity="sha512-xq+Vm8jC94ynOikewaQXMEkJIOBp7iArs3IhFWSWdRT3Pq8wFz46p+ZDFAR7kHnSFf+zUv52B3prRYnbDRdgog=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- Datatables -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.2/js/bootstrap.min.js"
      integrity="sha512-WW8/jxkELe2CAiE4LvQfwm1rajOS8PHasCCx+knHG0gBHt8EXxS6T6tJRTGuDQVnluuAvMxWF4j8SNFDKceLFg=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
      integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- toaster jquery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.min.js" integrity="sha512-zlWWyZq71UMApAjih4WkaRpikgY9Bz1oXIW5G0fED4vk14JjGlQ1UmkGM392jEULP8jbNMiwLWdM8Z87Hu88Fw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-toast-plugin/1.3.2/jquery.toast.css" integrity="sha512-8D+M+7Y6jVsEa7RD6Kv/Z7EImSpNpQllgaEIQAtqHcI0H6F4iZknRj0Nx1DCdB+TwBaS+702BGWYC0Ze2hpExQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- dataTables cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
      integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body class="bg-gradient-primary">

    <div class="container">
        <div class="card o-hidden border-0 shadow-lg my-5">
            <div class="card-body p-0">
                <!-- Nested Row within Card Body -->
                <div class="row">
                    <div class="col-lg-5 d-none d-lg-block bg-register-image"></div>
                    <div class="col-lg-7">
                        <div class="p-5">
                            <div class="text-center">
                                <h1 class="h4 text-gray-900 mb-4">Create New User!</h1>
                            </div>
                            <div class="container mt-5">
                              <!-- init form -->
                              <form id="insert_form" method="POST" autocomplete="on">
                                <div class="form-group">
                                  <input type="hidden" id="txt_for" name="txt_for" value="INSERT">
                                  <!-- <input type="hidden" id="txt_for" name="txt_for"> -->
                                </div>
                                <div class="form-group">
                                  <label for="username">Username</label>
                                  <input type="text" name="txt_username" class="form-control" id="username" placeholder="Enter username">
                                  <!-- <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small> -->
                                </div>
                                <div class="form-group">
                                  <label for="password">Password</label>
                                  <input type="password" name="txt_password" class="form-control" id="password" placeholder="Password">
                                </div>
                                <!-- <div class="form-check">
                                    <input type="checkbox" class="form-check-input" id="exampleCheck1">
                                    <label class="form-check-label" for="exampleCheck1">Check me out</label>
                                </div> -->
                                <button type="submit" class="btn btn-primary">Submit</button>
                              </form>
                              <!-- end form -->
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
<!-- js section -->
<script>
  function show_add_form() {
    $('txt_for').value('INSERT');
  }

</script>

<script>
  $(document).ready(function () {
    // This function runs when the document is fully loaded
    $("#insert_form").validate({
      ignore: [],
      rules: {
        txt_username: {
          required: true,
          minlength: 1,
        },
        txt_password: {
          required: true,
          minlength: 1,
        }
      },
      messages: {
        txt_username: {
          required: 'Username is required',
          number: "Please provide a number",
          minlength: "Min length should be 1 char only",
          maxlength: "Max length should be 10 char"
        },
        txt_upassword: {
          required: 'Password is required',
          number: "Please provide a number",
          minlength: "Min length should be 1 char only",
          maxlength: "Max length should be 10 char"
        }

      },
      submitHandler: function (form) {
        // form submit
        let formData = new FormData(form);
        // insert form
        if ($('#txt_for').val() === 'INSERT') {
          console.log("Inside submit");

          $.ajax({
            url: '/saveUser',
            data: $('#insert_form').serializeArray(),
            dataType: 'json',
            method: 'POST',
            processData: true,
            error: function (error) {
              console.log(error);
            },
            success: function (results) {
              if(results.status == 200){
                  $.toast({
                    heading: "Success",
                    text: "Record Added Successfully",
                    position: 'top-right',
                    loaderBg: "#effff8",
                    icon: "success",
                    showHideTransition: 'plain',
                    allowToastClose: true,
                    hideAfter: 3500
                });
              }
              if(results.status == 500){
                $.toast({
                    heading: "Error",
                    text: "Internal Server Error",
                    position: 'top-right',
                    loaderBg: "#effff8",
                    icon: "error",
                    showHideTransition: 'plain',
                    allowToastClose: true,
                    hideAfter: 3500
                });
              }
            }
          })
        }

        if ($('#txt_for').val() === 'UPDATE') {
          console.log("Inside update");

          $.ajax({
            url: '/saveUser',
            data: $('#insert_form').serializeArray(),
            dataType: 'json',
            method: 'POST',
            processData: true,
            error: function (error) {
              console.log(error);
            },
            success: function (results) {
              if(results.status == 200){
                  $.toast({
                    heading: "Success",
                    text: "Record Added Successfully",
                    position: 'top-right',
                    loaderBg: "#effff8",
                    icon: "success",
                    showHideTransition: 'plain',
                    allowToastClose: true,
                    hideAfter: 3500
                });
              }
              if(results.status == 500){
                $.toast({
                    heading: "Error",
                    text: "Internal Server Error",
                    position: 'top-right',
                    loaderBg: "#effff8",
                    icon: "error",
                    showHideTransition: 'plain',
                    allowToastClose: true,
                    hideAfter: 3500
                });
              }
            }
          })
        }




      }
    });
  });
</script>

</body>

</html>